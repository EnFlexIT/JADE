# Makefile for JADE project - lib directory

# The following targets are not file names
.PHONY: all clean

AR = jar
ARFLAGS = c0vf

all:
	@echo Making library ...
	cd $(CLSDIR); \
	$(AR) $(ARFLAGS) $(LIBDIR)/$(LIBTOOLSNAME) jade/tools; \
	rm -rf jade/tools; \
	$(AR) $(ARFLAGS) $(LIBDIR)/$(LIBNAME) *.class jade; \
	rm -rf jade *.class; \
	$(AR) $(ARFLAGS) $(LIBDIR)/$(LIBBASE64NAME) starlight; \
	rm -rf starlight; \
	cd $(LIBDIR)

clean:
	rm -f $(LIBDIR)/$(LIBTOOLSNAME)
	rm -f $(LIBDIR)/$(LIBNAME)
	rm -f `find . -name '*~' -print`
	rm -f `find . -name '#*#' -print`
	rm -f `find . -name '*.class' -print`

batch:
	rm -f $(BATCH_LIB);
	echo '@REM ===============================================================' > $(BATCH_LIB)
	echo '@REM =           Generated by JADE Makefile. DO NOT EDIT           =' >> $(BATCH_LIB)
	echo '@REM ===============================================================' >> $(BATCH_LIB)
	echo >> $(BATCH_LIB)
	echo 'cd $(subst /,\\,$(subst $(ROOTDIR),.,$(CLSDIR)))' >> $(BATCH_LIB)
	echo '$(AR) $(ARFLAGS) ..\\lib\\$(LIBTOOLSNAME) jade\\tools' >> $(BATCH_LIB)
	echo 'rmdir /S /Q jade\\tools' >> $(BATCH_LIB)
	echo >> $(BATCH_LIB)
	echo '$(AR) $(ARFLAGS) ..\\lib\\$(LIBNAME) *.class jade' >> $(BATCH_LIB)
	echo 'rmdir /S /Q  jade' >> $(BATCH_LIB)
	echo 'del *.class' >> $(BATCH_LIB)
	echo >> $(BATCH_LIB)
	echo '$(AR) $(ARFLAGS) ..\\lib\\$(LIBBASE64NAME) starlight' >> $(BATCH_LIB)
	echo 'rmdir /S /Q starlight' >> $(BATCH_LIB)
	echo 'cd ..' >> $(BATCH_LIB)


